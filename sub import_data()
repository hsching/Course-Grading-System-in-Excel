Option Explicit
Public program_ws As Worksheet
Public datasheet As Worksheet
Public report_ws As Worksheet
Public IfFileImported As Boolean 'check if users imported data
Public FileName As String 'imported datafile name
Public last_col As Integer 'of data range
Public last_row As Integer 'of data range
Public cell As Range 'for each loop
Public i As Integer 'for loop
Public customA As Double
Public customB As Double
Public customC As Double
Public ImportData_btn As Button

Sub import_data() '(by Cathy)
    Dim FilePath As String
    Dim StartProgram_btn As Button
    Set program_ws = ThisWorkbook.Sheets(1)
    
    MsgBox "Please open the data file you want analyze.", , "Import Data"
    FilePath = Application.GetOpenFilename
    
    If FilePath = "False" Then 'if users cancel to choosing file
        On Error Resume Next 'if button doesn't exist, error occur
        If ActiveSheet.Buttons("ImportData_btn") Is Nothing Then 'check if the button exist, if not, then add one
            With [f10:h13]
                Set ImportData_btn = ActiveSheet.Buttons.Add(.Left, .Top, .Width, .Height)
            End With
            With ImportData_btn
                .name = "ImportData_btn"
                .Caption = "Import Data"
                .OnAction = "import_data"
                .Font.Size = 16
            End With
        End If
        On Error GoTo 0
        Exit Sub
    Else
        Application.ScreenUpdating = False
        FileName = Dir(FilePath) 'get the file name from file path
        Workbooks.Open (FilePath)
        IfFileImported = True
    End If

    program_ws.Activate
    On Error Resume Next
    If program_ws.Buttons("StartProgram_btn") Is Nothing Then
        With [e23:i26]
            Set StartProgram_btn = ActiveSheet.Buttons.Add(.Left, .Top, .Width, .Height)
        End With
        With StartProgram_btn
            .name = "StartProgram_btn"
            .Caption = "HKUST Grading System"
            .OnAction = "start"
            .Font.Size = 16
        End With
    End If
    
    If Not program_ws.Buttons("ImportData_btn") Is Nothing Then
        program_ws.Buttons("ImportData_btn").delete
    End If
    On Error GoTo 0
    
    Application.ScreenUpdating = True
End Sub
